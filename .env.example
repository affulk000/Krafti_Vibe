# ============================================
# Krafti Vibe - Environment Configuration
# ============================================
# Copy this file to .env and update with your values
# DO NOT commit .env file to version control

# ============================================
# Environment
# ============================================
ENV=development
# Options: development, staging, production

# ============================================
# Server Configuration
# ============================================
SERVER_HOST=0.0.0.0
PORT=3000
SERVER_READ_TIMEOUT=15s
SERVER_WRITE_TIMEOUT=15s
SERVER_IDLE_TIMEOUT=120s
SERVER_SHUTDOWN_TIMEOUT=30s

# ============================================
# Database Configuration (PostgreSQL)
# ============================================
DB_HOST=localhost
DB_PORT=5432
DB_USER=postgres
DB_PASSWORD=postgres
DB_NAME=krafti_vibe
DB_SSLMODE=disable
# Options: disable, require, verify-ca, verify-full

# Connection Pool Settings
DB_MAX_OPEN_CONNS=25
DB_MAX_IDLE_CONNS=5
DB_CONN_MAX_LIFETIME=5m
DB_CONN_MAX_IDLE_TIME=10m

# ============================================
# Redis Configuration
# ============================================
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0

# Redis Connection Pool
REDIS_MAX_RETRIES=3
REDIS_POOL_SIZE=10
REDIS_MIN_IDLE_CONNS=5
REDIS_DIAL_TIMEOUT=5s
REDIS_READ_TIMEOUT=3s
REDIS_WRITE_TIMEOUT=3s
REDIS_POOL_TIMEOUT=4s
REDIS_CONN_MAX_IDLE_TIME=30m

# ============================================
# Logto Authentication Configuration
# ============================================
# Get these values from your Logto admin console
# Essential for JWT token validation and M2M authentication

# Core Logto Configuration
LOGTO_ENDPOINT=https://your-tenant.logto.app
LOGTO_ISSUER=https://your-tenant.logto.app/oidc
LOGTO_JWKS_URI=https://your-tenant.logto.app/oidc/jwks
LOGTO_TOKEN_URI=https://your-tenant.logto.app/oidc/token
LOGTO_USERINFO_URI=https://your-tenant.logto.app/oidc/me

# Application Credentials
# Machine-to-Machine (M2M) Application
LOGTO_M2M_APP_ID=your_m2m_application_id
LOGTO_M2M_APP_SECRET=your_m2m_application_secret

# Web Application (Optional - for server-side auth flows)
LOGTO_WEB_APP_ID=your_web_application_id
LOGTO_WEB_APP_SECRET=your_web_application_secret

# API Resource Configuration
# Main API resource identifier
LOGTO_API_RESOURCE=https://api.kraftivibe.com

# Role-specific API resources
LOGTO_ADMIN_API_RESOURCE=https://api.kraftivibe.com/admin
LOGTO_ARTISAN_API_RESOURCE=https://api.kraftivibe.com/artisan
LOGTO_CUSTOMER_API_RESOURCE=https://api.kraftivibe.com/customer

# JWKS Cache Settings (seconds)
LOGTO_JWKS_CACHE_TTL=900
# How long to cache JWKS keys (15 minutes)

LOGTO_JWKS_REFRESH_WINDOW=60
# How often to refresh JWKS in background (1 minute)

LOGTO_CLOCK_SKEW_TOLERANCE=300
# Clock skew tolerance for JWT validation (5 minutes)

# Feature Flags
LOGTO_ENABLE_ORGANIZATIONS=true
# Enable organization/tenant support in tokens

LOGTO_ENABLE_M2M=true
# Enable machine-to-machine authentication

LOGTO_ENABLE_RBAC=true
# Enable role-based access control

LOGTO_VALIDATE_AUDIENCE=true
# Validate JWT audience claims

LOGTO_VALIDATE_ISSUER=true
# Validate JWT issuer claims

LOGTO_ENABLE_LOGGING=true
# Enable detailed Logto operation logging

LOGTO_ENABLE_BACKGROUND_REFRESH=true
# Enable background JWKS refresh

# Security Settings
LOGTO_REQUIRED_SCOPES=
# Comma-separated list of required scopes for all requests
# Example: service:read,booking:write

LOGTO_TRUSTED_AUDIENCES=https://api.kraftivibe.com
# Comma-separated list of trusted audience values

LOGTO_ALLOWED_ORIGINS=https://kraftivibe.com,https://app.kraftivibe.com
# Comma-separated list of allowed origins for CORS

# ============================================
# Application Settings
# ============================================
APP_NAME=Krafti Vibe API
APP_VERSION=1.0.0
LOG_LEVEL=info
# Options: debug, info, warn, error

# CORS Settings
CORS_ORIGINS=http://localhost:4200,http://localhost:3000,http://localhost:8080
# Use * for development, specific origins for production

# Rate Limiting
RATE_LIMIT_RPS=100
# Requests per second per IP/tenant

# Monitoring
ENABLE_METRICS=true
ENABLE_TRACING=false

# Request Timeout
REQUEST_TIMEOUT=30s

# ============================================
# File Storage (S3-Compatible)
# ============================================
STORAGE_TYPE=s3
# Options: s3, minio, local

# AWS S3
AWS_REGION=us-east-1
AWS_ACCESS_KEY_ID=your_access_key
AWS_SECRET_ACCESS_KEY=your_secret_key
AWS_S3_BUCKET=kraftivibe-uploads
AWS_S3_ENDPOINT=
# Leave empty for AWS, set for custom S3-compatible endpoints

# MinIO (for local development)
MINIO_ENDPOINT=localhost:9000
MINIO_ACCESS_KEY=minioadmin
MINIO_SECRET_KEY=minioadmin
MINIO_BUCKET=kraftivibe
MINIO_USE_SSL=false

# CDN
CDN_URL=https://cdn.kraftivibe.com
CDN_ENABLED=false

# File Upload Limits
MAX_UPLOAD_SIZE=10485760
# 10MB in bytes

# ============================================
# Email Service
# ============================================
EMAIL_PROVIDER=smtp
# Options: smtp, sendgrid, ses, mailgun

# SMTP Configuration
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USERNAME=your-email@gmail.com
SMTP_PASSWORD=your-app-password
SMTP_FROM_EMAIL=noreply@kraftivibe.com
SMTP_FROM_NAME=Krafti Vibe

# SendGrid
SENDGRID_API_KEY=your_sendgrid_api_key

# AWS SES
AWS_SES_REGION=us-east-1
AWS_SES_ACCESS_KEY=your_ses_access_key
AWS_SES_SECRET_KEY=your_ses_secret_key

# Mailgun
MAILGUN_DOMAIN=your-domain.mailgun.org
MAILGUN_API_KEY=your_mailgun_api_key

# ============================================
# SMS Service
# ============================================
SMS_PROVIDER=twilio
# Options: twilio, sns, africas_talking

# Twilio
TWILIO_ACCOUNT_SID=your_account_sid
TWILIO_AUTH_TOKEN=your_auth_token
TWILIO_PHONE_NUMBER=+1234567890

# AWS SNS
AWS_SNS_REGION=us-east-1
AWS_SNS_ACCESS_KEY=your_sns_access_key
AWS_SNS_SECRET_KEY=your_sns_secret_key

# Africa's Talking
AFRICAS_TALKING_USERNAME=your_username
AFRICAS_TALKING_API_KEY=your_api_key

# ============================================
# Push Notifications
# ============================================
# Firebase Cloud Messaging
FCM_SERVER_KEY=your_fcm_server_key
FCM_CREDENTIALS_FILE=./config/firebase-credentials.json

# Apple Push Notification Service
APNS_KEY_ID=your_key_id
APNS_TEAM_ID=your_team_id
APNS_BUNDLE_ID=com.kraftivibe.app
APNS_KEY_FILE=./config/apns-key.p8
APNS_PRODUCTION=false

# ============================================
# Payment Gateways
# ============================================

# Stripe
STRIPE_SECRET_KEY=sk_test_your_stripe_secret_key
STRIPE_PUBLISHABLE_KEY=pk_test_your_stripe_publishable_key
STRIPE_WEBHOOK_SECRET=whsec_your_webhook_secret

# PayStack (Africa)
PAYSTACK_SECRET_KEY=sk_test_your_paystack_secret
PAYSTACK_PUBLIC_KEY=pk_test_your_paystack_public
PAYSTACK_WEBHOOK_SECRET=your_webhook_secret

# PayPal
PAYPAL_MODE=sandbox
# Options: sandbox, live
PAYPAL_CLIENT_ID=your_paypal_client_id
PAYPAL_SECRET=your_paypal_secret

# ============================================
# Webhook Configuration
# ============================================
WEBHOOK_TIMEOUT=30s
WEBHOOK_MAX_RETRIES=3
WEBHOOK_RETRY_DELAY=5s

# ============================================
# Background Jobs
# ============================================
JOB_QUEUE_TYPE=redis
# Options: redis, rabbitmq, sqs

# RabbitMQ
RABBITMQ_URL=amqp://guest:guest@localhost:5672/

# AWS SQS
AWS_SQS_REGION=us-east-1
AWS_SQS_ACCESS_KEY=your_sqs_access_key
AWS_SQS_SECRET_KEY=your_sqs_secret_key
AWS_SQS_QUEUE_URL=https://sqs.us-east-1.amazonaws.com/123456789/kraftivibe

# Job Processing
MAX_JOB_WORKERS=10
JOB_TIMEOUT=5m

# ============================================
# Analytics & Monitoring
# ============================================

# Sentry (Error Tracking)
SENTRY_DSN=https://your-sentry-dsn@sentry.io/123456
SENTRY_ENVIRONMENT=development
SENTRY_TRACES_SAMPLE_RATE=0.1

# DataDog
DATADOG_API_KEY=your_datadog_api_key
DATADOG_APP_KEY=your_datadog_app_key
DATADOG_SITE=datadoghq.com

# Google Analytics
GA_TRACKING_ID=UA-XXXXXXXXX-X

# ============================================
# External Integrations
# ============================================

# Google Maps
GOOGLE_MAPS_API_KEY=your_google_maps_api_key

# Zoom (Video Conferencing)
ZOOM_CLIENT_ID=your_zoom_client_id
ZOOM_CLIENT_SECRET=your_zoom_client_secret

# Slack
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/WEBHOOK/URL
SLACK_BOT_TOKEN=xoxb-your-slack-bot-token

# ============================================
# Security & Compliance
# ============================================

# Encryption Keys
ENCRYPTION_KEY=your-32-byte-encryption-key-here
# Generate with: openssl rand -base64 32

# JWT Settings (if not using Logto for everything)
JWT_SECRET=your-jwt-secret-key-minimum-32-chars
JWT_EXPIRY=1h
JWT_REFRESH_EXPIRY=168h
# 7 days

# Session Settings
SESSION_SECRET=your-session-secret-key-minimum-32-chars
SESSION_TIMEOUT=24h

# IP Whitelisting (comma-separated)
IP_WHITELIST=
# Example: 192.168.1.1,10.0.0.0/8

# ============================================
# Feature Flags
# ============================================
ENABLE_REGISTRATION=true
ENABLE_SOCIAL_LOGIN=true
ENABLE_MFA=true
ENABLE_WEBHOOKS=true
ENABLE_API_VERSIONING=true
ENABLE_RATE_LIMITING=true
ENABLE_CACHING=true

# ============================================
# Tenant Settings
# ============================================
DEFAULT_TRIAL_DAYS=14
MAX_TENANTS_PER_USER=1
ALLOW_SUBDOMAIN_CHANGE=false
REQUIRE_EMAIL_VERIFICATION=true
REQUIRE_PHONE_VERIFICATION=false

# ============================================
# Business Rules
# ============================================
DEFAULT_CURRENCY=USD
DEFAULT_TIMEZONE=UTC
DEFAULT_LANGUAGE=en
SUPPORTED_LANGUAGES=en,es,fr,pt

# Booking Settings
MIN_BOOKING_LEAD_TIME_HOURS=2
MAX_ADVANCE_BOOKING_DAYS=90
DEFAULT_BOOKING_DURATION_MINUTES=60
ALLOW_SAME_DAY_BOOKING=true

# Payment Settings
PLATFORM_COMMISSION_RATE=15
# Percentage
MINIMUM_PAYOUT_AMOUNT=50.00

# ============================================
# Development Settings
# ============================================
DEBUG=false
ENABLE_PPROF=false
# Go profiling endpoints

ENABLE_SWAGGER=true
SWAGGER_HOST=localhost:3000
SWAGGER_BASE_PATH=/api/v1

# Hot Reload (Air)
AIR_PORT=3001

# ============================================
# Testing
# ============================================
TEST_DB_HOST=localhost
TEST_DB_PORT=5433
TEST_DB_NAME=krafti_vibe_test
TEST_REDIS_HOST=localhost
TEST_REDIS_PORT=6380

# ============================================
# Backup & Maintenance
# ============================================
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *
# Cron format: daily at 2 AM
BACKUP_RETENTION_DAYS=30

AUTO_CLEANUP_ENABLED=true
CLEANUP_SCHEDULE=0 3 * * *
# Cron format: daily at 3 AM

# ============================================
# Notes
# ============================================
# - Never commit .env file to version control
# - Use strong, unique passwords in production
# - Rotate secrets regularly
# - Use environment-specific .env files:
#   - .env.development
#   - .env.staging
#   - .env.production
# - Consider using a secrets manager in production:
#   - AWS Secrets Manager
#   - HashiCorp Vault
#   - Azure Key Vault
#   - Google Secret Manager
